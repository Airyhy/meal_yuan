<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Yuan & Yuan Dish - Materials</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=Source+Sans+3:wght@400;500;600&display=swap"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container">
      <header class="hero">
        <nav class="top-nav">
          <a class="nav-link" href="index.html">菜谱主页 / Dishes</a>
          <a class="nav-link active" href="materials.html">材料管理 / Materials</a>
        </nav>
        <h1>材料管理 / Materials</h1>
        <p>统一管理材料价格与门店信息 / Manage materials, prices, and store locations.</p>
      </header>

      <section class="card">
        <div class="materials-toolbar">
          <div>
            <h2>材料清单 / Materials Catalog</h2>
            <p class="helper">所有材料均与菜谱共享同一数据 / Shared data with dish pages.</p>
            <div class="store-legend">
              <span class="legend-item">
                <svg width="24" height="24" style="flex-shrink: 0;">
                  <circle cx="12" cy="12" r="11" fill="#00674f"/>
                  <text x="12" y="16" font-size="10" font-weight="700" fill="white" text-anchor="middle" font-family="Arial, sans-serif">WF</text>
                </svg>
                Whole Foods / 全食超市
              </span>
              <span class="legend-item">
                <svg width="24" height="24" style="flex-shrink: 0;">
                  <circle cx="12" cy="12" r="11" fill="#e31837"/>
                  <text x="12" y="17" font-size="12" font-weight="700" fill="white" text-anchor="middle" font-family="Arial, sans-serif">S</text>
                </svg>
                Safeway / 西夫韦
              </span>
              <span class="legend-item">
                <svg width="24" height="24" style="flex-shrink: 0;">
                  <rect width="24" height="24" rx="12" fill="#ff9500"/>
                  <text x="12" y="17" font-size="10" font-weight="700" fill="white" text-anchor="middle" font-family="Arial, sans-serif">99</text>
                </svg>
                Ranch 99 / 大华超市
              </span>
            </div>
          </div>
          <div class="materials-filter">
            <label for="store-filter">门店 / Store</label>
            <select id="store-filter">
              <option value="all">全部 / All</option>
              <option value="Whole Foods">Whole Foods / 全食超市</option>
              <option value="Safeway">Safeway / 西夫韦</option>
              <option value="Ranch99">Ranch 99 / 大华超市</option>
            </select>
          </div>
        </div>
        <div id="materials-grid" class="materials-grid"></div>
      </section>
    </main>

    <script>
      // Pre-check before loading
      console.log('Page loaded, about to load scripts');
      window.addEventListener('error', function(e) {
        console.error('Global error:', e.error, e.message, e.filename, e.lineno);
        const grid = document.getElementById('materials-grid');
        if (grid && grid.innerHTML.trim() === '') {
          grid.innerHTML = '<p style="color: red;">错误：' + e.message + '<br/>Error: ' + e.message + '</p>';
        }
      });
    </script>
    <script src="data.js"></script>
    <script>
      console.log('data.js loaded, window.DATA =', window.DATA);
      console.log('MATERIALS count:', window.DATA?.MATERIALS?.length);
      if (!window.DATA || !window.DATA.MATERIALS || window.DATA.MATERIALS.length === 0) {
        console.error('DATA not loaded correctly!');
        document.getElementById('materials-grid').innerHTML = 
          '<p style="color: red;">数据加载失败 / Data failed to load. Check console for errors.</p>';
      }
    </script>
    <script src="materials.js"></script>
  </body>
</html>
